<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h4 mb-0">Créer une entreprise</h1>
    <a class="btn btn-outline-secondary" [routerLink]="['/platform-admin/companies']">Retour</a>
  </div>

  <div class="card border-0 shadow-sm">
    <div class="card-body">
      <form [formGroup]="form" (ngSubmit)="submit()" novalidate>
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label">Nom de l’entreprise *</label>
            <input class="form-control" formControlName="companyName" />
            <div class="invalid-feedback d-block" *ngIf="form.controls.companyName.touched && form.controls.companyName.invalid">
              Nom requis.
            </div>
          </div>
          <div class="col-md-6">
            <label class="form-label">Email *</label>
            <input class="form-control" formControlName="email" type="email" />
            <div class="invalid-feedback d-block" *ngIf="form.controls.email.touched && form.controls.email.invalid">
              Email valide requis.
            </div>
          </div>

          <div class="col-md-6">
            <label class="form-label">Adresse</label>
            <input class="form-control" formControlName="address" />
          </div>
          <div class="col-md-3">
            <label class="form-label">Téléphone</label>
            <input class="form-control" formControlName="phone" />
          </div>
          <div class="col-md-3">
            <label class="form-label">Site web</label>
            <input class="form-control" formControlName="website" />
          </div>

          <div class="col-md-6">
            <label class="form-label">Plan d’abonnement *</label>
            <select class="form-select" formControlName="subscriptionPlanId">
              <option [ngValue]="null">Sélectionner…</option>
              <option *ngFor="let p of plans" [ngValue]="p.id">{{ p.name }} — {{ p.maxEmployees }} employés / {{ p.maxSites }} sites</option>
            </select>
            <div class="invalid-feedback d-block" *ngIf="form.controls.subscriptionPlanId.touched && form.controls.subscriptionPlanId.invalid">
              Plan requis.
            </div>
          </div>
        </div>

        <hr class="my-4" />
        <h5>Administrateur (propriétaire)</h5>
        <div class="row g-3">
          <div class="col-md-3">
            <label class="form-label">Prénom *</label>
            <input class="form-control" formControlName="adminFirstName" />
          </div>
          <div class="col-md-3">
            <label class="form-label">Nom *</label>
            <input class="form-control" formControlName="adminLastName" />
          </div>
          <div class="col-md-3">
            <label class="form-label">Username *</label>
            <input class="form-control" formControlName="adminUsername" />
          </div>
          <div class="col-md-3">
            <label class="form-label">Email admin *</label>
            <input class="form-control" formControlName="adminEmail" type="email" />
          </div>

          <div class="col-md-4">
            <label class="form-label">Mot de passe *</label>
            <div class="input-group">
              <input class="form-control" [type]="showPwd ? 'text' : 'password'" formControlName="adminPassword" />
              <button type="button" class="btn btn-outline-secondary" (click)="showPwd = !showPwd">
                <i class="bi" [ngClass]="showPwd ? 'bi-eye-slash' : 'bi-eye'"></i>
              </button>
            </div>
          </div>
        </div>

        <div class="d-flex align-items-center mt-4 gap-2">
          <button class="btn btn-primary" type="submit" [disabled]="loading">
            <span *ngIf="!loading">Créer</span>
            <span *ngIf="loading" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
          </button>
          <div class="text-danger" *ngIf="errorMsg">{{ errorMsg }}</div>
        </div>
      </form>
    </div>
  </div>
</div>